ScreenManager:
    IntroScreen:
    LoginScreen:
    SignupScreen:
    HomeScreen:
    ScannerScreen:
    ClassScreen:
    CreateClassScreen:

<IntroScreen>:
    name: "intro_screen"

    Image:
        source: "presentpo_logo.png"
        pos_hint: {"center_y":.7, "center_x":.5}
        size: 1, 1

    MDLabel:
        text: "Present Po!"
        bold: True
        theme_text_color: "Custom"
        text_color: "#EC994B"
        font_style: "H5"
        size_hint_y: None
        pos_hint: {"center_y":.32, "center_x":.58}

    MDLabel:
        text: "An Autonomous Attendance Management System"
        theme_text_color: "Custom"
        text_color: "#79747E"
        font_size: "15sp"
        size_hint_y: None
        pos_hint: {"center_y":.28, "center_x":.58}

    MDRectangleFlatButton:
        text: "Log In"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_y":.21, "center_x":.5}
        size_hint: .9, 0

        on_press: root.manager.current = "login_screen"

    MDRectangleFlatButton:
        text: "Sign Up"
        text_color: "#EC994B"
        font_size: "18sp"

        line_width: 1.1
        line_color: "#EC994B"

        pos_hint: {"center_y":.14, "center_x":.5}
        size_hint: .9, None
        on_press: root.manager.current = "signup_screen"

<LoginScreen>:
    name: "login_screen"

    MDLabel:
        text: "Welcome Back"
        font_style: "H4"
        bold: True
        halign: "center"
        pos_hint: {"center_y":.7}

    MDLabel:
        text: "Sign in to continue"
        theme_text_color: "Custom"
        text_color: "#79747E"
        font_style: "Subtitle1"
        halign: "center"
        pos_hint: {"center_y":.66}

    MDTextField:
        id: login_username
        hint_text: "Username"
        icon_left: "account"

        size_hint_x: None
        width: root.width * .8
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "center_y": 0.55}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        icon_left_color_normal: "#CAC4D0"
        icon_left_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDTextField:
        id: login_password
        hint_text: "Password"
        icon_left: "key-variant"
        password: True

        size_hint_x: None
        width: root.width * .8
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "center_y": 0.45}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        icon_left_color_normal: "#CAC4D0"
        icon_left_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_x": .84, "center_y": .45}
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            login_password.password = False if login_password.password is True else True

    MDRectangleFlatButton:
        text: "Log In"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_x":.5, "center_y": .35}
        size_hint: None, None
        width: root.width * .8

        on_press: app.login()
    MDTextButton:
        text: "Sign Up"
        bold: True
        theme_text_color: "Custom"
        text_color: "#EC994B"
        font_size: "16sp"

        pos_hint: {"center_x":.71, "center_y": .3}
        on_press: root.manager.current = "signup_screen"

    MDLabel:
        text: "Don't have an account?"
        theme_text_color: "Custom"
        text_color: "#79747E"
        font_size: "16sp"
        pos_hint: {"center_x":.71, "center_y": .3}

    Image:
        source: "valco_logo.png"
        allow_stretch: True
        size_hint: (.1, .1)
        pos_hint: {"center_x":.5, "center_y": .1}

<SignupScreen>:
    name: "signup_screen"

    MDLabel:
        text: "Get Started"
        theme_text_color: "Custom"
        text_color: "#000000"
        font_style: "H4"
        bold: True
        halign: "center"
        pos_hint: {"center_y":.8}

    MDLabel:
        text: "Create a new account"
        theme_text_color: "Custom"
        text_color: "#79747E"
        font_style: "Subtitle1"
        halign: "center"
        pos_hint: {"center_y":.76}

    MDTextField:
        id: signup_email
        hint_text: "Email address"
        icon_left: "email"

        size_hint_x: None
        width: root.width * .8
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "center_y": 0.65}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        icon_left_color_normal: "#CAC4D0"
        icon_left_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDTextField:
        id: signup_username
        hint_text: "Username"
        icon_left: "account"

        size_hint_x: None
        width: root.width * .8
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "center_y": 0.55}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        icon_left_color_normal: "#CAC4D0"
        icon_left_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDTextField:
        id: signup_password
        hint_text: "Password"
        icon_left: "lock"
        password: True

        size_hint_x: None
        width: root.width * .8
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "center_y": 0.45}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        icon_left_color_normal: "#CAC4D0"
        icon_left_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_x": .84, "center_y": .45}
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            signup_password.password = False if signup_password.password is True else True

    MDRectangleFlatButton:
        text: "Sign Up"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_x":.5, "center_y":.35}
        size_hint: None, None
        width: root.width * .8
        on_press: app.signup()


    MDTextButton:
        text: "Log In"
        bold: True
        theme_text_color: "Custom"
        text_color: "#EC994B"
        font_size: "16sp"

        pos_hint: {"center_x": .73, "center_y": .3}
        on_press: root.manager.current = "login_screen"

    MDLabel:
        text: "Already have an account?"
        theme_text_color: "Custom"
        text_color: "#79747E"
        font_size: "16sp"
        pos_hint: {"center_x": .70, "center_y": .3}

    Image:
        source: "valco_logo.png"
        allow_stretch: True
        size_hint: (.1, .1)
        pos_hint: {"center_x":.5, "center_y": .1}

<HomeScreen>:
    name: "home_screen"

    MDBottomNavigation:
        panel_color: "#FFFEFE"
        text_color_normal: "#C29E7E"
        text_color_active: "#EC994B"

        MDBottomNavigationItem:
            name: 'screen 1'
            text: 'Home'
            icon: 'home'

            MDBoxLayout:
                md_bg_color: "#CAC4D0"
                size_hint: None, None
                width: root.width
                height: "0.5dp"
                pos_hint: {"bottom": 1}

            MDBoxLayout:
                md_bg_color: "#EC994B"
                size_hint: None, None
                width: root.width
                height: "65dp"
                pos_hint: {"top": 1}

                MDLabel:
                    text: "    Home"
                    theme_text_color: "Custom"
                    text_color: "#FFFFFF"
                    font_size: "22sp"
                    bold: True
                    pos_hint: {"center_x":.5}

            MDBoxLayout:
                md_bg_color: "#F5DEB3"
                size_hint: None, None
                width: root.width
                height: "150dp"
                #size_hint: (.3, .10)
                pos: (0, 320)
                line_color: "#F5DEB3"

                MDLabel:
                    id: username
                    text: "Username"
                    theme_text_color: "Custom"
                    text_color: "#000000"
                    font_size: "17sp"
                    bold: True
                    pos: (0, 590)
                    #pos_hint: {"center_x":90}



        MDBottomNavigationItem:
            name: 'screen 2'
            text: 'Records'
            icon: 'file'

            MDBoxLayout:
                md_bg_color: "#CAC4D0"
                size_hint: None, None
                width: root.width
                height: "0.5dp"
                pos_hint: {"bottom": 1}

            MDBoxLayout:
                md_bg_color: "#EC994B"
                size_hint: None, None
                width: root.width
                height: "65dp"
                pos_hint: {"top": 1}

                MDLabel:
                    text: "    Class Record"
                    theme_text_color: "Custom"
                    text_color: "#FFFFFF"
                    font_size: "22sp"
                    bold: True
                    pos_hint: {"center_x":.5}

            MDScrollView:
                do_scroll_x: False
                do_scroll_y: True
                size_hint: .9, 1
                pos_hint: {"center_x": .5, "top": .9}

                MDCard:
                    md_bg_color: "#EC994B"
                    size_hint: 1, .25
                    halign: "center"
                    elevation: 1

                    MDBoxLayout:
                        md_bg_color: "#FFFFFF"
                        size_hint: 1, .33

                        TwoLineListItem:
                            text: "Class Name"
                            secondary_text: "Time Schedule"
                            secondary_font_style: "Body2"
                            on_press:
                                root.manager.current="class_screen"
                                app.show_attendance_table()

            MDRectangleFlatButton:
                text: "Create New Record"
                text_color: "white"
                font_size: "18sp"

                line_color: "#EC994B"
                md_bg_color: "#EC994B"

                pos_hint: {"center_x": .5, "center_y": .05}
                size_hint: .9, 0

                on_press: root.manager.current= "create_class_screen"

        MDBottomNavigationItem:
            name: 'screen 3'
            text: 'Account'
            icon: 'account'

            MDBoxLayout:
                md_bg_color: "#CAC4D0"
                size_hint: None, None
                width: root.width
                height: "0.5dp"
                pos_hint: {"bottom": 1}

            MDBoxLayout:
                md_bg_color: "#EC994B"
                size_hint: None, None
                width: root.width
                height: "65dp"
                pos_hint: {"top": 1}

                MDLabel:
                    text: "    Settings"
                    theme_text_color: "Custom"
                    text_color: "#FFFFFF"
                    font_size: "22sp"
                    bold: True
                    pos_hint: {"center_x":.5}

            MDIcon:
                icon: "account-circle"
                font_size: "96px"
                pos_hint: {"center_x": .5, "center_y": .8}

            MDLabel:
                text: "Username"
                font_style: "H4"
                bold: True
                halign: "center"
                pos_hint: {"top":1.2}

            MDLabel:
                text: "    Account Settings"
                font_style: "H6"
                pos_hint: {"top":1.1, "center_x":.5}

            MDList:
                size_hint: None, None
                width: root.width * .9
                pos_hint: {"top": .595, "center_x": .5}

                TwoLineIconListItem:
                    text: "Your Info"
                    secondary_text: "View and Edit Profile info"
                    secondary_font_style: "Body2"

                    IconLeftWidget:
                        icon: "account"

            MDLabel:
                text: "    Shortcuts"
                font_style: "H6"
                pos_hint: {"top": .932, "center_x": .5}

            MDList:
                size_hint: None, None
                width: root.width * .9
                pos_hint: {"top": .42, "center_x": .5}

                OneLineIconListItem:
                    text: "About us"

                    IconLeftWidget:
                        icon: "help-circle-outline"

                OneLineIconListItem:
                    text: "Help and Support"

                    IconLeftWidget:
                        icon: "headset"

                OneLineIconListItem:
                    text: "Logout"
                    on_release: app.show_logout_dialog()

                    IconLeftWidget:
                        icon: "logout"

<CreateClassScreen>
    name: "create_class_screen"

    MDBoxLayout:
        md_bg_color: "#EC994B"

        size_hint: None, None
        width: root.width
        height: "65dp"
        pos_hint: {"top": 1}

        MDIconButton:
            icon: "arrow-left"
            halign: "left"
            pos_hint: {"center_y": .5}
            theme_icon_color: "Custom"
            icon_color: "#FFFFFF"

            on_press: root.manager.current="home_screen"

        MDLabel:
            text: "  Create Class"
            theme_text_color: "Custom"
            text_color: "#FFFFFF"
            font_size: "22sp"
            bold: True
            halign: "left"
            pos_hint: {"center_y":.5}

    MDLabel:
        text: "    Content"
        font_style: "H6"
        pos_hint: {"top":1.38, "center_x":.5}

    MDTextField:
        id: create_class_name
        hint_text: "Class Name"
        mode: "rectangle"

        size_hint_x: None
        width: root.width * .9
        font_size: "18sp"
        pos_hint: {"center_x": 0.5, "top": .85}

        text_color_normal: "#49454F"
        text_color_focus: "#EC994B"
        hint_text_color_focus: "#49454F"
        line_color_focus: "#EC994B"

    MDLabel:
        text: "    Time Schedule"
        font_style: "H6"
        pos_hint: {"top":1.23, "center_x":.5}

    MDRectangleFlatIconButton:
        id: clock_button
        icon: "clock"
        text: "00:00 AM"
        font_size: "18sp"

        text_color: "black"
        icon_color: "#CAC4D0"
        md_bg_color: "#FFFFFF"
        line_color: "#49454F"

        size_hint: .40, 0
        pos_hint: {"top":.685, "center_x":.25}

        on_release: app.show_time_picker()

    MDLabel:
        text: "    Date Range"
        font_style: "H6"
        pos_hint: {"top":1.03, "center_x":.5}

    MDRectangleFlatIconButton:
        id: calendar_button
        icon: "calendar"
        text: "mm/dd/yyyy"
        font_size: "18sp"

        text_color: "black"
        icon_color: "#CAC4D0"
        md_bg_color: "#FFFFFF"
        line_color: "#49454F"

        size_hint: .40, 0
        pos_hint: {"top":.485, "center_x":.25}

        on_release: app.show_date_picker()

    MDRectangleFlatButton:
        text: "Create"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_x": .5, "center_y": .05}
        size_hint: .9, 0

<ClassScreen>
    name:"class_screen"

    MDBoxLayout:
        md_bg_color: "#EC994B"

        size_hint: None, None
        width: root.width
        height: "65dp"
        pos_hint: {"top": 1}

        MDIconButton:
            icon: "arrow-left"
            halign: "left"
            pos_hint: {"center_y": .5}
            theme_icon_color: "Custom"
            icon_color: "#FFFFFF"

            on_press: root.manager.current="home_screen"

    MDLabel:
        text: "    Class name"
        font_style: "H5"
        pos_hint: {"top": 1.35, "center_x": .5}

    AnchorLayout:
        id: data_layout

    MDRectangleFlatButton:
        text: "Open Sheets"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_x": .75, "center_y": .85}
        size_hint: .30, 0
        on_press: app.sheet_link()

    MDRectangleFlatButton:
        text: "Start Attendance"
        text_color: "white"
        font_size: "18sp"

        line_color: "#EC994B"
        md_bg_color: "#EC994B"

        pos_hint: {"center_x": .5, "center_y": .05}
        size_hint: .9, 0
        on_press:  root.manager.current = "scanner_screen"


<ScannerScreen>
    name: "scanner_screen"
    #:import ZBarCam kivy_garden.zbarcam.ZBarCam

    MDBoxLayout:
        md_bg_color: "#EC994B"

        size_hint: None, None
        width: root.width
        height: "65dp"
        pos_hint: {"top": 1}

        MDIconButton:
            icon: "arrow-left"
            halign: "left"
            pos_hint: {"center_y": .5}
            theme_icon_color: "Custom"
            icon_color: "#FFFFFF"

            on_press: root.manager.current="home_screen"

        MDLabel:
            text: "  Scan Attendance"
            theme_text_color: "Custom"
            text_color: "#FFFFFF"
            font_size: "22sp"
            bold: True
            halign: "left"
            pos_hint: {"center_y":.5}

    BoxLayout:
        orientation: 'vertical'
        ZBarCam:
            id: zbarcam
            # optional, override the camera index (default 0)
            camera_index: 0     # or try a different value
            # optional, by default checks all types
            code_types: 'QRCODE', 'EAN13'

        Label:
            id: qr
            size_hint: None, None
            size: self.texture_size[0], 50
            text: ', '.join([str(symbol.data) for symbol in zbarcam.symbols])


        MDRectangleFlatButton:
            text: "Scan QR"
            text_color: "white"
            font_size: "18sp"

            line_color: "#EC994B"
            md_bg_color: "#EC994B"

            pos_hint: {"center_x": .5, "center_y": .05}
            size_hint: .9, 0
            on_press:
                app.get_qr_value()
                app.daily_time_in()
